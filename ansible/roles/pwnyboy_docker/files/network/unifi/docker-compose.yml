version: "3.8"
services:
  app:
    container_name: network-controller
    image: lscr.io/linuxserver/unifi-controller:latest
    environment:
      PUID: "{{ docker_user.id }}"
      PGID: "{{ docker_user.id }}"
      TZ: "{{ timezone }}"
    volumes:
      - ./data:/config
      - /data/backups/unifi-controller:/config/data/backup
    networks:
      - default
      - proxy
    ports:
      - 3478:3478/udp
      - 8080:8080
      - 10001:10001/udp
      - 1900:1900/udp
      - 6789:6789
    labels:
      traefik.enable: true
      traefik.docker.network: proxy

      traefik.http.routers.network-unifi.entrypoints: https
      traefik.http.routers.network-unifi.rule: Host(`unifi.pwnyboy.com`)

      traefik.http.services.network-unifi.loadbalancer.server.scheme: https
      traefik.http.services.network-unifi.loadbalancer.server.port: 8443

networks:
  proxy:
    external: true
